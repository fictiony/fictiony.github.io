(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{d67e:function(t,i,e){"use strict";e.r(i);var r=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("canvas",{ref:"bg",staticClass:"absolute-center",style:t.bgStyle,attrs:{width:t.xGrids,height:t.yGrids}}),e("canvas",{ref:"grid",staticClass:"absolute-center",style:t.canvasStyle,attrs:{width:t.xGrids,height:t.yGrids}}),e("canvas",{ref:"path",staticClass:"absolute-center",style:t.canvasStyle,attrs:{width:t.xGrids,height:t.yGrids}}),e("div",{staticClass:"absolute",style:t.layerStyle},[e("MarkLayer",{ref:"mark"}),e("BrushCursor",{ref:"cursor"})],1)])},s=[],a=(e("ddb0"),e("2f62")),h=e("5cd2"),d=e("1c16"),l=e("b94e"),n=e("4ecc"),g={data:()=>({bgPattern:null}),computed:{...Object(a["e"])("edit",["xGrids","yGrids","gridSize","gridStates","pathStates","brushSize","brushPos"]),...Object(h["l"])("edit",["gridDirty","pathDirty"]),...Object(a["c"])("edit",["halfGridWidth","halfGridHeight"]),bgStyle(){const t=2*this.gridSize;return{width:this.xGrids*this.gridSize+2*t+"px",height:this.yGrids*this.gridSize+2*t+"px",border:t+"px solid #8886",imageRendering:"pixelated"}},canvasStyle(){return{width:this.xGrids*this.gridSize+"px",height:this.yGrids*this.gridSize+"px",imageRendering:"pixelated"}},layerStyle(){return{left:-this.halfGridWidth+"px",top:-this.halfGridHeight+"px"}},gridImageData(){if(this.gridStates)return new ImageData(this.xGrids,this.yGrids)},pathImageData(){if(this.pathStates)return new ImageData(this.xGrids,this.yGrids)}},watch:{xGrids:"refreshBgLater",yGrids:"refreshBgLater",gridDirty:"refreshDirtyGridLater",pathDirty:"refreshDirtyPathLater"},methods:{initBgPattern(){const t=document.createElement("canvas");t.width=2,t.height=2;const i=t.getContext("2d");i.fillStyle="#0001",i.fillRect(0,0,1,1),i.fillRect(1,1,1,1),i.fillStyle="#fff1",i.fillRect(0,1,1,1),i.fillRect(1,0,1,1),this.bgPattern=i.createPattern(t,"repeat")},refreshBg(){const t=this.$refs.bg.getContext("2d");t.clearRect(0,0,this.xGrids,this.yGrids),t.fillStyle=this.bgPattern,t.fillRect(0,0,this.xGrids,this.yGrids)},refreshBgLater:Object(d["a"])((function(){this.refreshBg()}),0),refreshDirtyGrid(){if(!this.gridDirty)return;const t="all"===this.gridDirty,i=t?this.gridStates:this.gridDirty;this.gridDirty=null,this.refreshDirtyArea(this.$refs.grid,this.gridImageData,this.gridStates,i,t,l["g"])},refreshDirtyGridLater:Object(d["a"])((function(){this.refreshDirtyGrid()}),0),refreshDirtyPath(){if(!this.pathDirty)return;const t="all"===this.pathDirty,i=t?this.pathStates:this.pathDirty;this.pathDirty=null,this.refreshDirtyArea(this.$refs.path,this.pathImageData,this.pathStates,i,t,l["h"])},refreshDirtyPathLater:Object(d["a"])((function(){this.refreshDirtyPath()}),0),refreshDirtyArea(t,i,e,r,s,a){if(!s&&0===r.size)return;const{data:h,width:d,height:g}=i;let[c,f,y,o]=[d,0,g,0];for(const p of r.keys()){const[t,i]=n["a"].idToXY(p),r=e.get(p)||0;Object(l["i"])(h,4*(t+i*d),...a(r)),s||(t<c&&(c=t),t>f&&(f=t),i<y&&(y=i),i>o&&(o=i))}const u=t.getContext("2d");s?u.putImageData(i,0,0):u.putImageData(i,0,0,c,y,f-c+1,o-y+1)}},mounted(){this.initBgPattern(),this.refreshBg(),this.gridDirty="all",this.pathDirty="all"}},c=g,f=e("2877"),y=Object(f["a"])(c,r,s,!1,null,null,null);i["default"]=y.exports}}]);