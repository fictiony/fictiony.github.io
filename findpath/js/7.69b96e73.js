(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"8b24":function(s,i,t){"use strict";t.r(i);var r=function(){var s=this,i=s.$createElement,t=s._self._c||i;return t("ZoomView",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse.preserveCursor",value:s.onDrag,expression:"onDrag",modifiers:{mouse:!0,preserveCursor:!0}}],ref:"view",staticClass:"absolute-full",class:"bg-grey-"+(s.$q.dark.isActive?9:4),attrs:{"min-x":Math.min(0,s.halfViewWidth-s.halfGridWidth-s.margin/s.viewZoom),"max-x":Math.max(0,s.halfGridWidth+s.margin/s.viewZoom-s.halfViewWidth),"min-y":Math.min(0,s.halfViewHeight-s.halfGridHeight-s.margin/s.viewZoom),"max-y":Math.max(0,s.halfGridHeight+s.margin/s.viewZoom-s.halfViewHeight),zoom:s.viewZoom,"min-zoom":s.minViewZoom,"max-zoom":s.maxViewZoom},on:{"update:zoom":function(i){s.viewZoom=i},"start-drag":s.refreshCursor,"stop-drag":s.refreshCursor,resize:function(i,t){return s.halfViewWidth=i/2,s.halfViewHeight=t/2}},nativeOn:{"!mousedown":function(i){return s.onPress.apply(null,arguments)},mousedown:function(i){return s.$clearFocus.apply(null,arguments)},mouseup:function(i){s.brushDown=!1},mousemove:function(i){return s.onMouseMove.apply(null,arguments)},mouseout:function(i){s.brushPos=null},"!touchstart":function(i){return s.onPress.apply(null,arguments)},touchstart:function(i){return s.$clearFocus.apply(null,arguments)},touchend:function(i){s.brushPos=null,s.brushDown=!1},touchcancel:function(i){s.brushPos=null,s.brushDown=!1}}},[t("router-view",{ref:"grid",attrs:{name:"grid"}})],1)},o=[],e=(t("ddb0"),t("2f62")),h=t("5cd2"),n=t("4d7f"),u=t.n(n),a={data:()=>({margin:50,halfViewWidth:100,halfViewHeight:100,brushDown:!1,brushDownPos:null,brushDir:0}),computed:{...Object(h["l"])("main",["viewZoom"]),...Object(e["c"])("main",["maxViewZoom","minViewZoom"]),...Object(e["e"])("edit",["xGrids","yGrids","autoFind","brushMode","lockBrushDir"]),...Object(h["l"])("edit",["pointMode","startPos","endPos","brushPos"]),...Object(e["c"])("edit",["halfGridWidth","halfGridHeight","getGridXY"]),isDragging(){return!(!this.$refs.view||!this.$refs.view.dragState)},showDrawCursor(){return this.brushDown||!(!this.pointMode&&!this.brushMode||!this.brushPos)}},provide(){return{page:this}},watch:{showDrawCursor:"refreshCursor",startPos(s){s&&(this.pointMode=2,this.endPos&&this.autoFind&&this.findPath(0))},endPos(s){s&&this.startPos&&this.autoFind&&this.findPath(0)}},methods:{...Object(e["b"])("edit",["brushDraw","findPath"]),pageToGridXY(s){const i=this.$refs.view.pageToViewXY(s.pageX,s.pageY),[t,r]=this.getGridXY(...i);return t<0||r<0||t>=this.xGrids||r>=this.yGrids?null:{x:t,y:r}},refreshCursor(){this.$setCursor(this.isDragging?"grabbing":this.showDrawCursor?"crosshair":"")},onPress(s){this.onMouseMove(s),(this.pointMode||this.brushMode)&&this.brushPos&&(u.a.isPressed(32)||(this.$refs.view.$forceSet("interactive",!1),setTimeout((()=>{this.$refs.view.$forceSet("interactive",!0)})),1===this.pointMode?this.startPos={...this.brushPos}:2===this.pointMode?this.endPos={...this.brushPos}:(this.brushDown=!0,this.brushDownPos={...this.brushPos},this.brushDir=0,this.brushDraw())))},onDrag(s){this.onMouseMove(s.evt),this.brushDown&&s.isFinal&&(this.brushDown=!1)},onMouseMove(s){s=s.touches?s.touches[0]||s.changedTouches[0]:s;const i=this.pageToGridXY(s);if(i){if((!this.brushPos||this.brushPos.x!==i.x||this.brushPos.y!==i.y)&&(this.brushPos=i,this.brushDown)){if(0===this.brushDir){const s=Math.abs(i.x-this.brushDownPos.x),t=Math.abs(i.y-this.brushDownPos.y);this.brushDir=s>t?1:2}this.lockBrushDir||u.a.isPressed(16)?this.brushDraw({x:2===this.brushDir?this.brushDownPos.x:i.x,y:1===this.brushDir?this.brushDownPos.y:i.y}):this.brushDraw()}}else this.brushPos=null}},mounted(){u.a.setScope("main")}},d=a,l=t("2877"),c=t("75c3"),w=t("eebe"),b=t.n(w),m=Object(l["a"])(d,r,o,!1,null,null,null);i["default"]=m.exports;b()(m,"directives",{TouchPan:c["a"]})}}]);